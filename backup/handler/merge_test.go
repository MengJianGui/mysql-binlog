package handler

import (
	"bytes"
	"encoding/base64"
	"fmt"
	"os"
	"testing"

	"github.com/mysql-binlog/siddontang/go-mysql/replication"
	"github.com/spaolacci/murmur3"

	"github.com/mysql-binlog/common/utils"
)

func TestString(t *testing.T) {
	str := "uwourowurnvhivshfhf"

	ch := make(chan int)

	go func(para string) {
		para = para + "abc"
		fmt.Println("in go routine ", para)
		ch <- 1
	}(str)

	<-ch
	fmt.Println(str)
}

func TestHash(t *testing.T) {
	hash := murmur3.New128()
	hash.Write([]byte("pengan4"))

	for _, bt := range hash.Sum(nil) {
		fmt.Print(int(bt & 0xff))
	}
}

func TestBase64(t *testing.T) {
	bts1 := []byte{'\224', 'Y', '\344', 'Y', '\017', '\025', '\000', '\000', '\000', 'g', '\000', '\000', '\000', 'k', '\000', '\000', '\000', '\000', '\000', '\004', '\000', '5', '.', '5', '.', '5', '4', '-', 'l', 'o', 'g', '\000', '\000', '\000', '\000', '\000', '\000', '\000', '\000', '\000', '\000', '\000', '\000', '\000', '\000', '\000', '\000', '\000', '\000', '\000', '\000', '\000', '\000', '\000', '\000', '\000', '\000', '\000', '\000', '\000', '\000', '\000', '\000', '\000', '\000', '\000', '\000', '\000', '\000', '\000', '\000', '\000', '\000', '\000', '\000', '\023', '8', '\r', '\000', '\b', '\000', '\022', '\000', '\004', '\004', '\004', '\004', '\022', '\000', '\000', 'T', '\000', '\004', '\032', '\b', '\000', '\000', '\000', '\b', '\b', '\b', '\002', '\000'}
	base64.StdEncoding.EncodeToString(bts1)
	fmt.Println(len(bts1))

	str := `uS+iWhMVAAAAMgAAAIUDAAAAABcCAAAAAAEABHRlc3QABXRlc3QxAAMD/v4E7nfe/QY=
uS+iWhgVAAAA4gIAAGcGAAAAABcCAAAAAAEAA///+BEnAAApADEwMDAxYzY4NGIzNmMtODg5Yi0x
MWU3LTkwZTktZjQwNjY5MjNjM2Y1JABjNjg0ZTBiYy04ODliLTExZTctOTBlOS1mNDA2NjkyM2Mz
ZjX4EScAAC4AMTAwMDExMDAwMWM2ODRiMzZjLTg4OWItMTFlNy05MGU5LWY0MDY2OTIzYzNmNSQA
YzY4NGUwYmMtODg5Yi0xMWU3LTkwZTktZjQwNjY5MjNjM2Y1+BInAAApADEwMDAyYzY4YWZhMjQt
ODg5Yi0xMWU3LTkwZTktZjQwNjY5MjNjM2Y1JABjNjhiMjYzNC04ODliLTExZTctOTBlOS1mNDA2
NjkyM2MzZjX4EicAAC4AMTAwMDIxMDAwMmM2OGFmYTI0LTg4OWItMTFlNy05MGU5LWY0MDY2OTIz
YzNmNSQAYzY4YjI2MzQtODg5Yi0xMWU3LTkwZTktZjQwNjY5MjNjM2Y1+BMnAAApADEwMDAzYzY5
MjQ2ZGEtODg5Yi0xMWU3LTkwZTktZjQwNjY5MjNjM2Y1JABjNjkyNGI5NC04ODliLTExZTctOTBl
OS1mNDA2NjkyM2MzZjX4EycAAC4AMTAwMDMxMDAwM2M2OTI0NmRhLTg4OWItMTFlNy05MGU5LWY0
MDY2OTIzYzNmNSQAYzY5MjRiOTQtODg5Yi0xMWU3LTkwZTktZjQwNjY5MjNjM2Y1+BQnAAApADEw
MDA0YzY5NDMxZjItODg5Yi0xMWU3LTkwZTktZjQwNjY5MjNjM2Y1JABjNjk0MzNiZS04ODliLTEx
ZTctOTBlOS1mNDA2NjkyM2MzZjX4FCcAAC4AMTAwMDQxMDAwNGM2OTQzMWYyLTg4OWItMTFlNy05
MGU5LWY0MDY2OTIzYzNmNSQAYzY5NDMzYmUtODg5Yi0xMWU3LTkwZTktZjQwNjY5MjNjM2Y1`
	fmt.Println(len(str))

	bts2 := []byte{'\271', '/', '\242', 'Z', '\030', '\025', '\000', '\000', '\000', '\342', '\002', '\000', '\000', 'g', '\006', '\000', '\000', '\000', '\000', '\027', '\002', '\000', '\000', '\000', '\000', '\001', '\000', '\003', '\377', '\377', '\370', '\021', '\'', '\000', '\000', ')', '\000', '1', '0', '0', '0', '1', 'c', '6', '8', '4', 'b', '3', '6', 'c', '-', '8', '8', '9', 'b', '-', '1', '1', 'e', '7', '-', '9', '0', 'e', '9', '-', 'f', '4', '0', '6', '6', '9', '2', '3', 'c', '3', 'f', '5', '$', '\000', 'c', '6', '8', '4', 'e', '0', 'b', 'c', '-', '8', '8', '9', 'b', '-', '1', '1', 'e', '7', '-', '9', '0', 'e', '9', '-', 'f', '4', '0', '6', '6', '9', '2', '3', 'c', '3', 'f', '5', '\370', '\021', '\'', '\000', '\000', '.', '\000', '1', '0', '0', '0', '1', '1', '0', '0', '0', '1', 'c', '6', '8', '4', 'b', '3', '6', 'c', '-', '8', '8', '9', 'b', '-', '1', '1', 'e', '7', '-', '9', '0', 'e', '9', '-', 'f', '4', '0', '6', '6', '9', '2', '3', 'c', '3', 'f', '5', '$', '\000', 'c', '6', '8', '4', 'e', '0', 'b', 'c', '-', '8', '8', '9', 'b', '-', '1', '1', 'e', '7', '-', '9', '0', 'e', '9', '-', 'f', '4', '0', '6', '6', '9', '2', '3', 'c', '3', 'f', '5', '\370', '\022', '\'', '\000', '\000', ')', '\000', '1', '0', '0', '0', '2', 'c', '6', '8', 'a', 'f', 'a', '2', '4', '-', '8', '8', '9', 'b', '-', '1', '1', 'e', '7', '-', '9', '0', 'e', '9', '-', 'f', '4', '0', '6', '6', '9', '2', '3', 'c', '3', 'f', '5', '$', '\000', 'c', '6', '8', 'b', '2', '6', '3', '4', '-', '8', '8', '9', 'b', '-', '1', '1', 'e', '7', '-', '9', '0', 'e', '9', '-', 'f', '4', '0', '6', '6', '9', '2', '3', 'c', '3', 'f', '5', '\370', '\022', '\'', '\000', '\000', '.', '\000', '1', '0', '0', '0', '2', '1', '0', '0', '0', '2', 'c', '6', '8', 'a', 'f', 'a', '2', '4', '-', '8', '8', '9', 'b', '-', '1', '1', 'e', '7', '-', '9', '0', 'e', '9', '-', 'f', '4', '0', '6', '6', '9', '2', '3', 'c', '3', 'f', '5', '$', '\000', 'c', '6', '8', 'b', '2', '6', '3', '4', '-', '8', '8', '9', 'b', '-', '1', '1', 'e', '7', '-', '9', '0', 'e', '9', '-', 'f', '4', '0', '6', '6', '9', '2', '3', 'c', '3', 'f', '5', '\370', '\023', '\'', '\000', '\000', ')', '\000', '1', '0', '0', '0', '3', 'c', '6', '9', '2', '4', '6', 'd', 'a', '-', '8', '8', '9', 'b', '-', '1', '1', 'e', '7', '-', '9', '0', 'e', '9', '-', 'f', '4', '0', '6', '6', '9', '2', '3', 'c', '3', 'f', '5', '$', '\000', 'c', '6', '9', '2', '4', 'b', '9', '4', '-', '8', '8', '9', 'b', '-', '1', '1', 'e', '7', '-', '9', '0', 'e', '9', '-', 'f', '4', '0', '6', '6', '9', '2', '3', 'c', '3', 'f', '5', '\370', '\023', '\'', '\000', '\000', '.', '\000', '1', '0', '0', '0', '3', '1', '0', '0', '0', '3', 'c', '6', '9', '2', '4', '6', 'd', 'a', '-', '8', '8', '9', 'b', '-', '1', '1', 'e', '7', '-', '9', '0', 'e', '9', '-', 'f', '4', '0', '6', '6', '9', '2', '3', 'c', '3', 'f', '5', '$', '\000', 'c', '6', '9', '2', '4', 'b', '9', '4', '-', '8', '8', '9', 'b', '-', '1', '1', 'e', '7', '-', '9', '0', 'e', '9', '-', 'f', '4', '0', '6', '6', '9', '2', '3', 'c', '3', 'f', '5', '\370', '\024', '\'', '\000', '\000', ')', '\000', '1', '0', '0', '0', '4', 'c', '6', '9', '4', '3', '1', 'f', '2', '-', '8', '8', '9', 'b', '-', '1', '1', 'e', '7', '-', '9', '0', 'e', '9', '-', 'f', '4', '0', '6', '6', '9', '2', '3', 'c', '3', 'f', '5', '$', '\000', 'c', '6', '9', '4', '3', '3', 'b', 'e', '-', '8', '8', '9', 'b', '-', '1', '1', 'e', '7', '-', '9', '0', 'e', '9', '-', 'f', '4', '0', '6', '6', '9', '2', '3', 'c', '3', 'f', '5', '\370', '\024', '\'', '\000', '\000', '.', '\000', '1', '0', '0', '0', '4', '1', '0', '0', '0', '4', 'c', '6', '9', '4', '3', '1', 'f', '2', '-', '8', '8', '9', 'b', '-', '1', '1', 'e', '7', '-', '9', '0', 'e', '9', '-', 'f', '4', '0', '6', '6', '9', '2', '3', 'c', '3', 'f', '5', '$', '\000', 'c', '6', '9', '4', '3', '3', 'b', 'e', '-', '8', '8', '9', 'b', '-', '1', '1', 'e', '7', '-', '9', '0', 'e', '9', '-', 'f', '4', '0', '6', '6', '9', '2', '3', 'c', '3', 'f', '5'}

	rst := utils.Base64Encode(bts2)

	fmt.Println(string(rst))
}

func TestBase64Equals(t *testing.T) {
	cout := `uS+iWhgVAAAA4gIAAGcGAAAAABcCAAAAAAEAA///+BEnAAApADEwMDAxYzY4NGIzNmMtODg5Yi0x
MWU3LTkwZTktZjQwNjY5MjNjM2Y1JABjNjg0ZTBiYy04ODliLTExZTctOTBlOS1mNDA2NjkyM2Mz
ZjX4EScAAC4AMTAwMDExMDAwMWM2ODRiMzZjLTg4OWItMTFlNy05MGU5LWY0MDY2OTIzYzNmNSQA
YzY4NGUwYmMtODg5Yi0xMWU3LTkwZTktZjQwNjY5MjNjM2Y1+BInAAApADEwMDAyYzY4YWZhMjQt
ODg5Yi0xMWU3LTkwZTktZjQwNjY5MjNjM2Y1JABjNjhiMjYzNC04ODliLTExZTctOTBlOS1mNDA2
NjkyM2MzZjX4EicAAC4AMTAwMDIxMDAwMmM2OGFmYTI0LTg4OWItMTFlNy05MGU5LWY0MDY2OTIz
YzNmNSQAYzY4YjI2MzQtODg5Yi0xMWU3LTkwZTktZjQwNjY5MjNjM2Y1+BMnAAApADEwMDAzYzY5
MjQ2ZGEtODg5Yi0xMWU3LTkwZTktZjQwNjY5MjNjM2Y1JABjNjkyNGI5NC04ODliLTExZTctOTBl
OS1mNDA2NjkyM2MzZjX4EycAAC4AMTAwMDMxMDAwM2M2OTI0NmRhLTg4OWItMTFlNy05MGU5LWY0
MDY2OTIzYzNmNSQAYzY5MjRiOTQtODg5Yi0xMWU3LTkwZTktZjQwNjY5MjNjM2Y1+BQnAAApADEw
MDA0YzY5NDMxZjItODg5Yi0xMWU3LTkwZTktZjQwNjY5MjNjM2Y1JABjNjk0MzNiZS04ODliLTEx
ZTctOTBlOS1mNDA2NjkyM2MzZjX4FCcAAC4AMTAwMDQxMDAwNGM2OTQzMWYyLTg4OWItMTFlNy05
MGU5LWY0MDY2OTIzYzNmNSQAYzY5NDMzYmUtODg5Yi0xMWU3LTkwZTktZjQwNjY5MjNjM2Y1`
	goout := `uS+iWhgVAAAA4gIAAGcGAAAAABcCAAAAAAEAA///+BEnAAApADEwMDAxYzY4NGIzNmMtODg5Yi0x
MWU3LTkwZTktZjQwNjY5MjNjM2Y1JABjNjg0ZTBiYy04ODliLTExZTctOTBlOS1mNDA2NjkyM2Mz
ZjX4EScAAC4AMTAwMDExMDAwMWM2ODRiMzZjLTg4OWItMTFlNy05MGU5LWY0MDY2OTIzYzNmNSQA
YzY4NGUwYmMtODg5Yi0xMWU3LTkwZTktZjQwNjY5MjNjM2Y1+BInAAApADEwMDAyYzY4YWZhMjQt
ODg5Yi0xMWU3LTkwZTktZjQwNjY5MjNjM2Y1JABjNjhiMjYzNC04ODliLTExZTctOTBlOS1mNDA2
NjkyM2MzZjX4EicAAC4AMTAwMDIxMDAwMmM2OGFmYTI0LTg4OWItMTFlNy05MGU5LWY0MDY2OTIz
YzNmNSQAYzY4YjI2MzQtODg5Yi0xMWU3LTkwZTktZjQwNjY5MjNjM2Y1+BMnAAApADEwMDAzYzY5
MjQ2ZGEtODg5Yi0xMWU3LTkwZTktZjQwNjY5MjNjM2Y1JABjNjkyNGI5NC04ODliLTExZTctOTBl
OS1mNDA2NjkyM2MzZjX4EycAAC4AMTAwMDMxMDAwM2M2OTI0NmRhLTg4OWItMTFlNy05MGU5LWY0
MDY2OTIzYzNmNSQAYzY5MjRiOTQtODg5Yi0xMWU3LTkwZTktZjQwNjY5MjNjM2Y1+BQnAAApADEw
MDA0YzY5NDMxZjItODg5Yi0xMWU3LTkwZTktZjQwNjY5MjNjM2Y1JABjNjk0MzNiZS04ODliLTEx
ZTctOTBlOS1mNDA2NjkyM2MzZjX4FCcAAC4AMTAwMDQxMDAwNGM2OTQzMWYyLTg4OWItMTFlNy05
MGU5LWY0MDY2OTIzYzNmNSQAYzY5NDMzYmUtODg5Yi0xMWU3LTkwZTktZjQwNjY5MjNjM2Y1`

	if cout == goout {
		fmt.Println("equal is true")
	}
}

func TestBase64Decode(t *testing.T) {
	// table map event
	str := `3ve5WhMVAAAASwAAAPQJAAAAAEYAAAAAAAEABHljc2IACXVzZXJ0YWJsZQALD/z8/Pz8/Pz8/PwM
/QICAgICAgICAgIC/gcR4mNH`
	bt, err := base64.StdEncoding.DecodeString(str)
	if err != nil {
		fmt.Println(err)
	}

	header := &replication.EventHeader{}
	header.Decode(bt)
	fmt.Println(header)

	tme := &replication.TableMapEvent{}
	tme.Decode(bt[19:])
	fmt.Println(tme)

	fmt.Println(len(bt))
}

func TestUpdateRowEvent(t *testing.T) {
	str := `2HKiWh8VAAAA5x8AAE4hAAAAAEYAAAAAAAAAAgAD///4CAIAAAAAAAAkAGFlMGRmOTEzLTU4MzAt
NDI0OS1hZDE4LTdhNzVmM2MzYWE4ZCQAM2VkZTA1Y2YtNmU4NC00MDMwLTk3YzQtODVhNWM3NGJm
YWRh+AgCAAAAAAAAJABhZTBkZjkxMy01ODMwLTQyNDktYWQxOC03YTc1ZjNjM2FhOGQnADUyMDNl
ZGUwNWNmLTZlODQtNDAzMC05N2M0LTg1YTVjNzRiZmFkYfgJAgAAAAAAACQAZDllMzA3ZDgtMWUx
Mi00ODllLTlhNDktYmUwMzRjZmJkZjY5JABlNmE3YzliNi05YWI1LTQ2NGQtOWRkYy0xZTA4MjZl
Mzc3Yzf4CQIAAAAAAAAkAGQ5ZTMwN2Q4LTFlMTItNDg5ZS05YTQ5LWJlMDM0Y2ZiZGY2OScANTIx
ZTZhN2M5YjYtOWFiNS00NjRkLTlkZGMtMWUwODI2ZTM3N2M3+AoCAAAAAAAAJAA2NTYxZTA3Yi04
OTZmLTQ2ODYtYjU5MS1lNWFjMzIzZDkzZWYkAGIyZDQ4YWUyLTE0ZmMtNGNjNi05ODAxLTI1ZjEz
NDhhYjFiYvgKAgAAAAAAACQANjU2MWUwN2ItODk2Zi00Njg2LWI1OTEtZTVhYzMyM2Q5M2VmJwA1
MjJiMmQ0OGFlMi0xNGZjLTRjYzYtOTgwMS0yNWYxMzQ4YWIxYmL4CwIAAAAAAAAkADdlYmEzOWZk
LTA4NDQtNDQ0ZS1iYzY3LWE2MzU0ZDFiZjUyYSQAYzY2NWMxMjAtOTVmNC00NTdiLTk5MWEtMGJi
ZWNhNzY2NzU5+AsCAAAAAAAAJAA3ZWJhMzlmZC0wODQ0LTQ0NGUtYmM2Ny1hNjM1NGQxYmY1MmEn
ADUyM2M2NjVjMTIwLTk1ZjQtNDU3Yi05OTFhLTBiYmVjYTc2Njc1OfgMAgAAAAAAACQAZWY5ZDBj
NGMtM2E5Yy00ZDRjLTk4ZGUtMzFkZTNmY2JjNzNlJABjNmE0YjAwYS1jNjI2LTQyMjItYTk0ZC1k
N2RjNmUxZGU2ZTn4DAIAAAAAAAAkAGVmOWQwYzRjLTNhOWMtNGQ0Yy05OGRlLTMxZGUzZmNiYzcz
ZScANTI0YzZhNGIwMGEtYzYyNi00MjIyLWE5NGQtZDdkYzZlMWRlNmU5+A0CAAAAAAAAJAAyYzMy
YWRjOC0zMjg5LTQ1MTctODMzOS1jZjg2Y2RjYTBiYTUkADc4ZGU5OGUzLTE4OWMtNDM4NC05MGM3
LTJjMWI2YTkwNzk1NvgNAgAAAAAAACQAMmMzMmFkYzgtMzI4OS00NTE3LTgzMzktY2Y4NmNkY2Ew
YmE1JwA1MjU3OGRlOThlMy0xODljLTQzODQtOTBjNy0yYzFiNmE5MDc5NTb4DgIAAAAAAAAkADhm
MTM4YzI5LWFjOWItNDBhOS1hM2Q5LTJhNzk2NTgyM2Y2ZSQAZDQ0M2ZkMDAtOTc1OS00ZDgxLWE0
OTAtZGE4MzVjODc4MmI2+A4CAAAAAAAAJAA4ZjEzOGMyOS1hYzliLTQwYTktYTNkOS0yYTc5NjU4
MjNmNmUnADUyNmQ0NDNmZDAwLTk3NTktNGQ4MS1hNDkwLWRhODM1Yzg3ODJiNvgPAgAAAAAAACQA
NzQ5NjhjZDMtNzVkNC00NWRiLWE1MjItOTZjNzgyNjAwN2Q5JAA2ZDQzNDNkZC02M2Y2LTRkMTkt
ODJiNS1mYzYzZjM5ZTdlMjL4DwIAAAAAAAAkADc0OTY4Y2QzLTc1ZDQtNDVkYi1hNTIyLTk2Yzc4
MjYwMDdkOScANTI3NmQ0MzQzZGQtNjNmNi00ZDE5LTgyYjUtZmM2M2YzOWU3ZTIy+BACAAAAAAAA
JAA3Y2Y3Nzk1Yy1kZjcwLTQ3MjQtYjE4Yy02OWM3ZDVlZTMwNzQkADEwMTc4ZjA4LWM3NTItNDZi
MS05NTgzLTg3ZmY1NDZlMzkzNPgQAgAAAAAAACQAN2NmNzc5NWMtZGY3MC00NzI0LWIxOGMtNjlj
N2Q1ZWUzMDc0JwA1MjgxMDE3OGYwOC1jNzUyLTQ2YjEtOTU4My04N2ZmNTQ2ZTM5MzT4EQIAAAAA
AAAkADZlMjU3N2VmLWUwNmEtNGY1Yi04NjNjLTBiNDBiNTljNjdjOCQANTZjOGZmYTktMGQ5ZS00
MGIyLWE2NGUtYTJiMmY1MGMxMjk3+BECAAAAAAAAJAA2ZTI1NzdlZi1lMDZhLTRmNWItODYzYy0w
YjQwYjU5YzY3YzgnADUyOTU2YzhmZmE5LTBkOWUtNDBiMi1hNjRlLWEyYjJmNTBjMTI5N/gSAgAA
AAAAACQAYTFmNDkyOWMtYWYwNS00YmQ5LWFhZmUtNGFlOTcyOWI3NDczJAA3Y2NhYzY2My1lMWZj
LTQ5MzUtOTBlZC1iNjg4ZjYwZGUzNzX4EgIAAAAAAAAkAGExZjQ5MjljLWFmMDUtNGJkOS1hYWZl
LTRhZTk3MjliNzQ3MycANTMwN2NjYWM2NjMtZTFmYy00OTM1LTkwZWQtYjY4OGY2MGRlMzc1+BMC
AAAAAAAAJABjNjQwNDUzYi1iOGJkLTRjZDctODcyMi04Mzc5NjU1ZGY5NDckAGMwYTE5MDQ4LTAz
ODYtNDgyYS04MzVkLTBlYjI4YmU3MDcxNvgTAgAAAAAAACQAYzY0MDQ1M2ItYjhiZC00Y2Q3LTg3
MjItODM3OTY1NWRmOTQ3JwA1MzFjMGExOTA0OC0wMzg2LTQ4MmEtODM1ZC0wZWIyOGJlNzA3MTb4
FAIAAAAAAAAkAGYzNjI4ZDExLWRiY2ItNDBhZS1hZjM0LTlmM2Y4YzA1MzljOCQAMjI0ODZlYTMt
ZjI1OC00MDk3LTgwMzktMGVjOTRhMGY5ZTk5+BQCAAAAAAAAJABmMzYyOGQxMS1kYmNiLTQwYWUt
YWYzNC05ZjNmOGMwNTM5YzgnADUzMjIyNDg2ZWEzLWYyNTgtNDA5Ny04MDM5LTBlYzk0YTBmOWU5
OfgVAgAAAAAAACQANjczZGI2ZWYtN2YxYy00Y2YxLTk4MjEtZDZhNDQ1N2U1YzFlJAAwY2I2OTkw
Yi1hN2Y1LTRjMGUtYjFmZS1lZmE0NDBmYWNlNmL4FQIAAAAAAAAkADY3M2RiNmVmLTdmMWMtNGNm
MS05ODIxLWQ2YTQ0NTdlNWMxZScANTMzMGNiNjk5MGItYTdmNS00YzBlLWIxZmUtZWZhNDQwZmFj
ZTZi+BYCAAAAAAAAJAA0YjhmYTAxNC0zYzgwLTQwNmYtYWVhOS1kYTBkYmI4ZGE4Y2IkAGMwYjA2
NmJlLThmNTEtNGY3Zi05Zjk1LTI1MGI5M2IyMmQ3OPgWAgAAAAAAACQANGI4ZmEwMTQtM2M4MC00
MDZmLWFlYTktZGEwZGJiOGRhOGNiJwA1MzRjMGIwNjZiZS04ZjUxLTRmN2YtOWY5NS0yNTBiOTNi
MjJkNzj4FwIAAAAAAAAkAGMyNjExNDA5LWIzYjktNDMyZi04OTE3LTE1MjE3MGJhNzViOSQANDgz
ZDhmOGUtMzIyNS00ZmQwLWFjMTktMTYyNWMyOThlNjEx+BcCAAAAAAAAJABjMjYxMTQwOS1iM2I5
LTQzMmYtODkxNy0xNTIxNzBiYTc1YjknADUzNTQ4M2Q4ZjhlLTMyMjUtNGZkMC1hYzE5LTE2MjVj
Mjk4ZTYxMfgYAgAAAAAAACQAZmY2YjE1NzAtNTYzMS00ODFmLWIyYTctOWM5MTI2NjYyZWNjJABh
Zjc3NmFjYS00ODI2LTQwODUtYTllNS05YmZiZWRlNjllMWH4GAIAAAAAAAAkAGZmNmIxNTcwLTU2
MzEtNDgxZi1iMmE3LTljOTEyNjY2MmVjYycANTM2YWY3NzZhY2EtNDgyNi00MDg1LWE5ZTUtOWJm
YmVkZTY5ZTFh+BkCAAAAAAAAJAA3YjM0MWI1Ny1lODAyLTQzMjMtOWQ1Yi1lNjM2MzEzNDEwYjEk
ADBiZGVjYmNhLTc1NWYtNDkyOC04ZGE5LWJkYjViYjJmMjAyOPgZAgAAAAAAACQAN2IzNDFiNTct
ZTgwMi00MzIzLTlkNWItZTYzNjMxMzQxMGIxJwA1MzcwYmRlY2JjYS03NTVmLTQ5MjgtOGRhOS1i
ZGI1YmIyZjIwMjj4GgIAAAAAAAAkADM1ZThkNGU5LTBiYjEtNDljZS1iMzE1LWU5MjgzYjRkMzI3
ZSQANDk5NjVlMDctZDZmYS00ZjVhLWI5ODQtODljODUzODA5ZTUz+BoCAAAAAAAAJAAzNWU4ZDRl
OS0wYmIxLTQ5Y2UtYjMxNS1lOTI4M2I0ZDMyN2UnADUzODQ5OTY1ZTA3LWQ2ZmEtNGY1YS1iOTg0
LTg5Yzg1MzgwOWU1M/gbAgAAAAAAACQANzkxZmIwYjUtMzc2YS00Nzk1LTkzMjktMjM1YWQxMWJi
OTQyJAAwNzIyYjc5Ni0yMTE2LTRjNWQtYmY4OC1jNDU1YzFhOWMxMTP4GwIAAAAAAAAkADc5MWZi
MGI1LTM3NmEtNDc5NS05MzI5LTIzNWFkMTFiYjk0MicANTM5MDcyMmI3OTYtMjExNi00YzVkLWJm
ODgtYzQ1NWMxYTljMTEz+BwCAAAAAAAAJAAxY2ZjMmQ4My00NTA1LTQwOTUtYmU4ZC1mMGNiZGE1
NGFiY2QkAGQ4ZGVhY2QzLTI0NGMtNGMzOC1iY2M5LTJkODMwNjU1ZjAxOPgcAgAAAAAAACQAMWNm
YzJkODMtNDUwNS00MDk1LWJlOGQtZjBjYmRhNTRhYmNkJwA1NDBkOGRlYWNkMy0yNDRjLTRjMzgt
YmNjOS0yZDgzMDY1NWYwMTj4HQIAAAAAAAAkADdmYWVlNTRkLTFmNzItNDg5ZC1iNGNkLTM3ZDll
YWI5ZmM0YSQAMzM2MzRlZDgtN2QxZS00MGU3LWI4ZTYtNGQ4YzI4MTNmZmZk+B0CAAAAAAAAJAA3
ZmFlZTU0ZC0xZjcyLTQ4OWQtYjRjZC0zN2Q5ZWFiOWZjNGEnADU0MTMzNjM0ZWQ4LTdkMWUtNDBl
Ny1iOGU2LTRkOGMyODEzZmZmZPgeAgAAAAAAACQAMWY1M2U3NjQtNmU3NS00YTJiLTk4NmUtNTc1
NjQ4YmNmYjU3JABmNTY3MDI0NS1lMWRhLTRmOWQtYjNlZS01MjMyNDgyZWRlZWL4HgIAAAAAAAAk
ADFmNTNlNzY0LTZlNzUtNGEyYi05ODZlLTU3NTY0OGJjZmI1NycANTQyZjU2NzAyNDUtZTFkYS00
ZjlkLWIzZWUtNTIzMjQ4MmVkZWVi+B8CAAAAAAAAJAA2YjIxNzk0ZC02MTQxLTRjMjEtODUxNC1j
MTA5ZGQwMTdhN2IkADg3NGM0MmY1LTRhNjItNDMwNy1iNjdkLTIyNTk3ZDkzZTcyMPgfAgAAAAAA
ACQANmIyMTc5NGQtNjE0MS00YzIxLTg1MTQtYzEwOWRkMDE3YTdiJwA1NDM4NzRjNDJmNS00YTYy
LTQzMDctYjY3ZC0yMjU5N2Q5M2U3MjD4IAIAAAAAAAAkADIyYmU2MTE5LWRlNWEtNGFlZC05MWEx
LWE0MmJiYWRmZDAwYyQAMjE0OTc3OTAtOGYyMS00OTNmLTgxYTgtMzM2N2UwMzExZmNh+CACAAAA
AAAAJAAyMmJlNjExOS1kZTVhLTRhZWQtOTFhMS1hNDJiYmFkZmQwMGMnADU0NDIxNDk3NzkwLThm
MjEtNDkzZi04MWE4LTMzNjdlMDMxMWZjYfghAgAAAAAAACQAMmEyMWNhZGYtYjExMi00Y2JlLTgy
ODItZDc1MzQyOTZjZGZkJAA3MTY2MmUwYS1iODNjLTQ3MjktOGY1NS1iZGZmODFkZmQwN2L4IQIA
AAAAAAAkADJhMjFjYWRmLWIxMTItNGNiZS04MjgyLWQ3NTM0Mjk2Y2RmZCcANTQ1NzE2NjJlMGEt
YjgzYy00NzI5LThmNTUtYmRmZjgxZGZkMDdi+CICAAAAAAAAJAA3MGYwODJjYy1hYjhiLTQ2NzMt
ODVlNS03ZWY2M2JjMDRiN2IkADQzNmU3Njk1LTFiYzctNDAxYi05MGRiLTRlYWRiZDM4NDAwNPgi
AgAAAAAAACQANzBmMDgyY2MtYWI4Yi00NjczLTg1ZTUtN2VmNjNiYzA0YjdiJwA1NDY0MzZlNzY5
NS0xYmM3LTQwMWItOTBkYi00ZWFkYmQzODQwMDT4IwIAAAAAAAAkAGI4Zjg4MmI5LTk2OTgtNGRh
MS04NzZlLTA1ZWQ4NDgzOTA3YyQAMmE0ZDliM2UtYTNlNy00ZWQ2LWFmZGYtNTRmZWJlOWE2NGE5
+CMCAAAAAAAAJABiOGY4ODJiOS05Njk4LTRkYTEtODc2ZS0wNWVkODQ4MzkwN2MnADU0NzJhNGQ5
YjNlLWEzZTctNGVkNi1hZmRmLTU0ZmViZTlhNjRhOfgkAgAAAAAAACQAMGEzOTVjNzItNmZkYS00
ZjU0LWIyNGQtMjg4NjVhOTNiZWEzJABjMmQwN2FjYy1hMmQ0LTQ5YzctOWJhMi04ZTExMWRlZmNk
ZmL4JAIAAAAAAAAkADBhMzk1YzcyLTZmZGEtNGY1NC1iMjRkLTI4ODY1YTkzYmVhMycANTQ4YzJk
MDdhY2MtYTJkNC00OWM3LTliYTItOGUxMTFkZWZjZGZi+CUCAAAAAAAAJABlMWE1MmRmNC1kMjE0
LTQ1ZmQtYWViOC0zYzc5ODcyMmZkZjMkADAwOGNiNDkwLTlhNWUtNDZhZi04YjE1LTdjMzhlMjYx
MDNkMfglAgAAAAAAACQAZTFhNTJkZjQtZDIxNC00NWZkLWFlYjgtM2M3OTg3MjJmZGYzJwA1NDkw
MDhjYjQ5MC05YTVlLTQ2YWYtOGIxNS03YzM4ZTI2MTAzZDH4JgIAAAAAAAAkADVmN2NlOGFjLTIz
Y2EtNDE0NS04ZGNjLWFkZjY3OGYxYTY1NCQANTQ0ZjYwZDctMTAwNC00ZTAxLWE1ZjktZDBmZjY4
ODU2N2Y4+CYCAAAAAAAAJAA1ZjdjZThhYy0yM2NhLTQxNDUtOGRjYy1hZGY2NzhmMWE2NTQnADU1
MDU0NGY2MGQ3LTEwMDQtNGUwMS1hNWY5LWQwZmY2ODg1NjdmOPgnAgAAAAAAACQANmY5YzBkNTYt
ODE5Yi00YzNiLWFkYjEtMmE4ZGE0NTJmYTE3JABiOGQxNGYyZC01YWMyLTRhNTMtODE4NC1hZWM1
NDQzYjM3MzP4JwIAAAAAAAAkADZmOWMwZDU2LTgxOWItNGMzYi1hZGIxLTJhOGRhNDUyZmExNycA
NTUxYjhkMTRmMmQtNWFjMi00YTUzLTgxODQtYWVjNTQ0M2IzNzMz+CgCAAAAAAAAJAAzM2JlZjg5
ZS02M2NiLTRiMGEtODc0ZS0zN2Q4YmYwMTNlZDgkADZhZDFmYTliLTlmMDAtNDAzMC1iZDc2LTJh
ZTc1Njg3MGU1MPgoAgAAAAAAACQAMzNiZWY4OWUtNjNjYi00YjBhLTg3NGUtMzdkOGJmMDEzZWQ4
JwA1NTI2YWQxZmE5Yi05ZjAwLTQwMzAtYmQ3Ni0yYWU3NTY4NzBlNTD4KQIAAAAAAAAkADNiNzUz
ODU4LTlhMmUtNDcwOC04MTJhLWFiNWMyNjQ2MGE3ZSQAYTQ5YTQzOWQtMmUwNS00NDk2LTlhNGIt
Y2FhMTliMWVlNjEy+CkCAAAAAAAAJAAzYjc1Mzg1OC05YTJlLTQ3MDgtODEyYS1hYjVjMjY0NjBh
N2UnADU1M2E0OWE0MzlkLTJlMDUtNDQ5Ni05YTRiLWNhYTE5YjFlZTYxMvgqAgAAAAAAACQAZTI3
NThmYjctMTkwMy00NjYzLTg2YzQtMjFiNDZmMTc3OTdmJABiOTNhNGY5YS1iZTViLTQwMzQtOTNk
Yy1kYWY1ZGRiYjBmMDX4KgIAAAAAAAAkAGUyNzU4ZmI3LTE5MDMtNDY2My04NmM0LTIxYjQ2ZjE3
Nzk3ZicANTU0YjkzYTRmOWEtYmU1Yi00MDM0LTkzZGMtZGFmNWRkYmIwZjA1+CsCAAAAAAAAJABi
ZjMxMzU1MS05OWUwLTQzNDItODRlYS00NWVmZjdjZmEyNGIkADQzM2I1ZDU5LTMyMjItNGExYi04
NWE2LTRkM2Q1YzZkNzdhYfgrAgAAAAAAACQAYmYzMTM1NTEtOTllMC00MzQyLTg0ZWEtNDVlZmY3
Y2ZhMjRiJwA1NTU0MzNiNWQ1OS0zMjIyLTRhMWItODVhNi00ZDNkNWM2ZDc3YWH4LAIAAAAAAAAk
ADYyYzU3NmY4LTJiNTMtNDJmNS1iODRkLWVkYThmNWE2N2Y0MSQAOTRhY2YxZTAtZjNmYi00ZDZj
LWJjYzQtYTE4OGNiNzI3OTdk+CwCAAAAAAAAJAA2MmM1NzZmOC0yYjUzLTQyZjUtYjg0ZC1lZGE4
ZjVhNjdmNDEnADU1Njk0YWNmMWUwLWYzZmItNGQ2Yy1iY2M0LWExODhjYjcyNzk3ZPgtAgAAAAAA
ACQAYmM1MzI1MDctYjc1NS00NGNjLTgzNjAtNDRmNjVhMTQyN2UzJAAwMDhiMDkxNi1hZWRhLTRh
NTgtYWZlNi1iMjMzZjYyMTFmOTb4LQIAAAAAAAAkAGJjNTMyNTA3LWI3NTUtNDRjYy04MzYwLTQ0
ZjY1YTE0MjdlMycANTU3MDA4YjA5MTYtYWVkYS00YTU4LWFmZTYtYjIzM2Y2MjExZjk2+C4CAAAA
AAAAJABlNTU1YjQ4NS1jYTM0LTQ1Y2QtOGM1OC02MWZiZWZjOGM2YjAkADIzYjUxNzI5LTcwYzkt
NGE3Ny1iNTQwLTRmZjM1ODhlYTI2MfguAgAAAAAAACQAZTU1NWI0ODUtY2EzNC00NWNkLThjNTgt
NjFmYmVmYzhjNmIwJwA1NTgyM2I1MTcyOS03MGM5LTRhNzctYjU0MC00ZmYzNTg4ZWEyNjH4LwIA
AAAAAAAkAGU1ZmNkMzhiLTUzODAtNGU3NS1iYmM1LTk5NDQ0OWVkZTZjOCQAOWNkNjY1ZTUtMjAy
Ny00ZWRjLTk0M2QtZTk2NDAxOTA2Njc2+C8CAAAAAAAAJABlNWZjZDM4Yi01MzgwLTRlNzUtYmJj
NS05OTQ0NDllZGU2YzgnADU1OTljZDY2NWU1LTIwMjctNGVkYy05NDNkLWU5NjQwMTkwNjY3Nvgw
AgAAAAAAACQAYzcwMzBmNjAtOTYxNi00NzNhLWI0MDUtZTlkMjJjYjhjOGFmJAAyMGE3NTFkMy1l
YmZkLTQzZDQtOTcxZC1kOTRjZmRmNzJjOGH4MAIAAAAAAAAkAGM3MDMwZjYwLTk2MTYtNDczYS1i
NDA1LWU5ZDIyY2I4YzhhZicANTYwMjBhNzUxZDMtZWJmZC00M2Q0LTk3MWQtZDk0Y2ZkZjcyYzhh
+DECAAAAAAAAJAA3NzZmYTRiZi1lYjQxLTRhNDEtYTlmNy02ZjE2Y2Q4YTAzMDEkADBhNTM3ZmM0
LWU5ZDctNDQzNS04YjAzLWUzYjdmMGI0MjFmZPgxAgAAAAAAACQANzc2ZmE0YmYtZWI0MS00YTQx
LWE5ZjctNmYxNmNkOGEwMzAxJwA1NjEwYTUzN2ZjNC1lOWQ3LTQ0MzUtOGIwMy1lM2I3ZjBiNDIx
ZmT4MgIAAAAAAAAkADI5MWQ1OWRhLTBhZWItNGQyYy1iZmIzLWFlM2JkOGFjZjM4NSQAZDllNzc0
MGMtODExZC00ZmU3LTk1OTgtMTA1NDZjOTI5Yjdm+DICAAAAAAAAJAAyOTFkNTlkYS0wYWViLTRk
MmMtYmZiMy1hZTNiZDhhY2YzODUnADU2MmQ5ZTc3NDBjLTgxMWQtNGZlNy05NTk4LTEwNTQ2Yzky
OWI3ZvgzAgAAAAAAACQANjEwNTNiYjUtMzg4My00MmEzLTk2MjQtNTJhMDA5ZjMzYTI0JABkMjgy
YTUyOS0yZTQ1LTQ0MTYtYjAwNi05MGQyZWZhZjM2OWT4MwIAAAAAAAAkADYxMDUzYmI1LTM4ODMt
NDJhMy05NjI0LTUyYTAwOWYzM2EyNCcANTYzZDI4MmE1MjktMmU0NS00NDE2LWIwMDYtOTBkMmVm
YWYzNjlk+DQCAAAAAAAAJAA5YTY5ZjVmYi1mMzVhLTQ1NGUtYTNiZi1hODUxZDdiZDJjZjAkAGQx
ZDE3YmE5LTg5YmItNDNjNy04ZGUwLWI0NmM2OTU4MjQ2OPg0AgAAAAAAACQAOWE2OWY1ZmItZjM1
YS00NTRlLWEzYmYtYTg1MWQ3YmQyY2YwJwA1NjRkMWQxN2JhOS04OWJiLTQzYzctOGRlMC1iNDZj
Njk1ODI0Njj4NQIAAAAAAAAkAGI3ZTVlNzViLThlYmUtNDQ1Mi04OTc4LTA0ZDlkZjFjM2IzOCQA
NzNiY2EzY2MtMmIwYi00MGIzLWEyYmEtZGVjMWYyZWQwODkx+DUCAAAAAAAAJABiN2U1ZTc1Yi04
ZWJlLTQ0NTItODk3OC0wNGQ5ZGYxYzNiMzgnADU2NTczYmNhM2NjLTJiMGItNDBiMy1hMmJhLWRl
YzFmMmVkMDg5Mfg2AgAAAAAAACQAMjAxNWMxZTAtNGEwYS00MDJkLTllMDItMjE4YjE5NDZjMzdj
JAA1MGQ4MWMxNS0xN2M2LTQ0MDItODhjYy1kOTQ1ZjhlOWNlNTX4NgIAAAAAAAAkADIwMTVjMWUw
LTRhMGEtNDAyZC05ZTAyLTIxOGIxOTQ2YzM3YycANTY2NTBkODFjMTUtMTdjNi00NDAyLTg4Y2Mt
ZDk0NWY4ZTljZTU1lzfHcQ==`

	bt, err := base64.StdEncoding.DecodeString(str)
	if err != nil {
		fmt.Println(err)
	}

	header := &replication.EventHeader{}
	header.Decode(bt)
	fmt.Println(header)

	re := &replication.RowsEvent{}
	re.Decode(bt[19:])
	fmt.Println(re)

	fmt.Println(bt[0:19])

	fmt.Println(len(str), "  ", len(bt))
}

func TestBase64Size(t *testing.T) {
	str := `2HKiWh8VAAAAFiAAACkoDQAAAEYAAAAAAAAAAgAD///4IBUAAAAAAAAkADY0YmZlYmQxLTZmMGYt
NDNjZC1hMjZmLWI1NzBlMThhMjc2NCQAYzNmODlmYjAtMGU2MC00YTYzLWEzNjctYWFkNzFhNWUx
Y2Yy+CAVAAAAAAAAJAA2NGJmZWJkMS02ZjBmLTQzY2QtYTI2Zi1iNTcwZTE4YTI3NjQoADU0MDhj
M2Y4OWZiMC0wZTYwLTRhNjMtYTM2Ny1hYWQ3MWE1ZTFjZjL4IRUAAAAAAAAkADY0YmZlYmQxLTZm
MGYtNDNjZC1hMjZmLWI1NzBlMThhMjc2NCQAYzNmODlmYjAtMGU2MC00YTYzLWEzNjctYWFkNzFh
NWUxY2Yy+CEVAAAAAAAAJAA2NGJmZWJkMS02ZjBmLTQzY2QtYTI2Zi1iNTcwZTE4YTI3NjQoADU0
MDljM2Y4OWZiMC0wZTYwLTRhNjMtYTM2Ny1hYWQ3MWE1ZTFjZjL4IhUAAAAAAAAkAGEzOTc0MjQx
LTFmYWEtNGJmNi05YmVkLTM4OWRhNDkwNTc0ZCQAOTFlZDMxYTEtYzIxOC00MGQ3LTgzYzQtOTdm
OWViNDM5YTU5+CIVAAAAAAAAJABhMzk3NDI0MS0xZmFhLTRiZjYtOWJlZC0zODlkYTQ5MDU3NGQo
ADU0MTA5MWVkMzFhMS1jMjE4LTQwZDctODNjNC05N2Y5ZWI0MzlhNTn4IxUAAAAAAAAkAGEzOTc0
MjQxLTFmYWEtNGJmNi05YmVkLTM4OWRhNDkwNTc0ZCQAOTFlZDMxYTEtYzIxOC00MGQ3LTgzYzQt
OTdmOWViNDM5YTU5+CMVAAAAAAAAJABhMzk3NDI0MS0xZmFhLTRiZjYtOWJlZC0zODlkYTQ5MDU3
NGQoADU0MTE5MWVkMzFhMS1jMjE4LTQwZDctODNjNC05N2Y5ZWI0MzlhNTn4JBUAAAAAAAAkAGMx
YWNjOGRkLWM3YzUtNDE4NS1hMTk1LWU0ZWJmODJkYjYwMSQAZjU4M2M2MzctNDhhMS00ODM4LWFi
MTUtZmI3YTc0ZTI5YzEw+CQVAAAAAAAAJABjMWFjYzhkZC1jN2M1LTQxODUtYTE5NS1lNGViZjgy
ZGI2MDEoADU0MTJmNTgzYzYzNy00OGExLTQ4MzgtYWIxNS1mYjdhNzRlMjljMTD4JRUAAAAAAAAk
AGMxYWNjOGRkLWM3YzUtNDE4NS1hMTk1LWU0ZWJmODJkYjYwMSQAZjU4M2M2MzctNDhhMS00ODM4
LWFiMTUtZmI3YTc0ZTI5YzEw+CUVAAAAAAAAJABjMWFjYzhkZC1jN2M1LTQxODUtYTE5NS1lNGVi
ZjgyZGI2MDEoADU0MTNmNTgzYzYzNy00OGExLTQ4MzgtYWIxNS1mYjdhNzRlMjljMTD4JhUAAAAA
AAAkADVjMTQ1MDM0LTg2OWUtNDIxYy04YzM2LWM0YmQ1YmIzYWZlMyQAMWUxZDAxYmYtOGY5Mi00
MGY3LTg1MmItMDY5NWEyOTc4MmM3+CYVAAAAAAAAJAA1YzE0NTAzNC04NjllLTQyMWMtOGMzNi1j
NGJkNWJiM2FmZTMoADU0MTQxZTFkMDFiZi04ZjkyLTQwZjctODUyYi0wNjk1YTI5NzgyYzf4JxUA
AAAAAAAkADVjMTQ1MDM0LTg2OWUtNDIxYy04YzM2LWM0YmQ1YmIzYWZlMyQAMWUxZDAxYmYtOGY5
Mi00MGY3LTg1MmItMDY5NWEyOTc4MmM3+CcVAAAAAAAAJAA1YzE0NTAzNC04NjllLTQyMWMtOGMz
Ni1jNGJkNWJiM2FmZTMoADU0MTUxZTFkMDFiZi04ZjkyLTQwZjctODUyYi0wNjk1YTI5NzgyYzf4
KBUAAAAAAAAkAGJiMjhlNjY5LTNlZTAtNGQ3Yy04NTQ2LWM0YTljODNiOGZhYSQAYWNhZTZjMGIt
MTMxNi00YjEyLThiMWMtNjY3OTFkNmExMGUx+CgVAAAAAAAAJABiYjI4ZTY2OS0zZWUwLTRkN2Mt
ODU0Ni1jNGE5YzgzYjhmYWEoADU0MTZhY2FlNmMwYi0xMzE2LTRiMTItOGIxYy02Njc5MWQ2YTEw
ZTH4KRUAAAAAAAAkAGJiMjhlNjY5LTNlZTAtNGQ3Yy04NTQ2LWM0YTljODNiOGZhYSQAYWNhZTZj
MGItMTMxNi00YjEyLThiMWMtNjY3OTFkNmExMGUx+CkVAAAAAAAAJABiYjI4ZTY2OS0zZWUwLTRk
N2MtODU0Ni1jNGE5YzgzYjhmYWEoADU0MTdhY2FlNmMwYi0xMzE2LTRiMTItOGIxYy02Njc5MWQ2
YTEwZTH4KhUAAAAAAAAkADI5YWY0ZmI3LTJkYWYtNDg5Yy05ZjFhLTEyNjI4NzIyMjIyOSQAMjk0
OTJmOWMtN2NjMy00ZWViLWEyNWMtYWY5MTViODJhOWQw+CoVAAAAAAAAJAAyOWFmNGZiNy0yZGFm
LTQ4OWMtOWYxYS0xMjYyODcyMjIyMjkoADU0MTgyOTQ5MmY5Yy03Y2MzLTRlZWItYTI1Yy1hZjkx
NWI4MmE5ZDD4KxUAAAAAAAAkADI5YWY0ZmI3LTJkYWYtNDg5Yy05ZjFhLTEyNjI4NzIyMjIyOSQA
Mjk0OTJmOWMtN2NjMy00ZWViLWEyNWMtYWY5MTViODJhOWQw+CsVAAAAAAAAJAAyOWFmNGZiNy0y
ZGFmLTQ4OWMtOWYxYS0xMjYyODcyMjIyMjkoADU0MTkyOTQ5MmY5Yy03Y2MzLTRlZWItYTI1Yy1h
ZjkxNWI4MmE5ZDD4LBUAAAAAAAAkADc3MTJhMWI3LTQzNWMtNDVmMS1hYTFkLTdmZDAwZTk0YmIy
YiQAYjE4YzkzOWQtMTdhNC00MmJjLWJhZDUtMjY3YjMzY2I3Zjc1+CwVAAAAAAAAJAA3NzEyYTFi
Ny00MzVjLTQ1ZjEtYWExZC03ZmQwMGU5NGJiMmIoADU0MjBiMThjOTM5ZC0xN2E0LTQyYmMtYmFk
NS0yNjdiMzNjYjdmNzX4LRUAAAAAAAAkADc3MTJhMWI3LTQzNWMtNDVmMS1hYTFkLTdmZDAwZTk0
YmIyYiQAYjE4YzkzOWQtMTdhNC00MmJjLWJhZDUtMjY3YjMzY2I3Zjc1+C0VAAAAAAAAJAA3NzEy
YTFiNy00MzVjLTQ1ZjEtYWExZC03ZmQwMGU5NGJiMmIoADU0MjFiMThjOTM5ZC0xN2E0LTQyYmMt
YmFkNS0yNjdiMzNjYjdmNzX4LhUAAAAAAAAkAGVkYjhjNDg5LTk4OTgtNGIxZC05MjU2LTIzM2Y2
YjEyMWM0YSQAN2I3MTE0OTQtNGIyMi00ZTBlLWFkMjUtODQ2MDFiOTM5MDkx+C4VAAAAAAAAJABl
ZGI4YzQ4OS05ODk4LTRiMWQtOTI1Ni0yMzNmNmIxMjFjNGEoADU0MjI3YjcxMTQ5NC00YjIyLTRl
MGUtYWQyNS04NDYwMWI5MzkwOTH4LxUAAAAAAAAkAGVkYjhjNDg5LTk4OTgtNGIxZC05MjU2LTIz
M2Y2YjEyMWM0YSQAN2I3MTE0OTQtNGIyMi00ZTBlLWFkMjUtODQ2MDFiOTM5MDkx+C8VAAAAAAAA
JABlZGI4YzQ4OS05ODk4LTRiMWQtOTI1Ni0yMzNmNmIxMjFjNGEoADU0MjM3YjcxMTQ5NC00YjIy
LTRlMGUtYWQyNS04NDYwMWI5MzkwOTH4MBUAAAAAAAAkAGE5NDRjNjdjLTgzMDAtNDlkYS1iNzdm
LTNkY2ViY2U4NWZhZSQAZDhhY2I4OTAtYTExOS00MjJiLWJkY2YtNDE5MDA0Y2U2NDEw+DAVAAAA
AAAAJABhOTQ0YzY3Yy04MzAwLTQ5ZGEtYjc3Zi0zZGNlYmNlODVmYWUoADU0MjRkOGFjYjg5MC1h
MTE5LTQyMmItYmRjZi00MTkwMDRjZTY0MTD4MRUAAAAAAAAkAGE5NDRjNjdjLTgzMDAtNDlkYS1i
NzdmLTNkY2ViY2U4NWZhZSQAZDhhY2I4OTAtYTExOS00MjJiLWJkY2YtNDE5MDA0Y2U2NDEw+DEV
AAAAAAAAJABhOTQ0YzY3Yy04MzAwLTQ5ZGEtYjc3Zi0zZGNlYmNlODVmYWUoADU0MjVkOGFjYjg5
MC1hMTE5LTQyMmItYmRjZi00MTkwMDRjZTY0MTD4MhUAAAAAAAAkADc0N2E3Y2EyLWUzNzgtNDQx
MS1hNDY5LTI0MWExNzY4NGYzOCQANjMzYzVkNDYtNzQ4ZC00Y2RlLWIxMTgtZjQ1NDRkNThiYjk5
+DIVAAAAAAAAJAA3NDdhN2NhMi1lMzc4LTQ0MTEtYTQ2OS0yNDFhMTc2ODRmMzgoADU0MjY2MzNj
NWQ0Ni03NDhkLTRjZGUtYjExOC1mNDU0NGQ1OGJiOTn4MxUAAAAAAAAkADc0N2E3Y2EyLWUzNzgt
NDQxMS1hNDY5LTI0MWExNzY4NGYzOCQANjMzYzVkNDYtNzQ4ZC00Y2RlLWIxMTgtZjQ1NDRkNThi
Yjk5+DMVAAAAAAAAJAA3NDdhN2NhMi1lMzc4LTQ0MTEtYTQ2OS0yNDFhMTc2ODRmMzgoADU0Mjc2
MzNjNWQ0Ni03NDhkLTRjZGUtYjExOC1mNDU0NGQ1OGJiOTn4NBUAAAAAAAAkADEzNWI0MzdkLTU4
NjYtNDczNC04ZDJjLTgwMTljZGI3YTVjNSQAYTJhMGM5NzQtODk5ZC00NDRlLTk3OWQtODcyMmI4
MmE4Y2Mx+DQVAAAAAAAAJAAxMzViNDM3ZC01ODY2LTQ3MzQtOGQyYy04MDE5Y2RiN2E1YzUoADU0
MjhhMmEwYzk3NC04OTlkLTQ0NGUtOTc5ZC04NzIyYjgyYThjYzH4NRUAAAAAAAAkADEzNWI0Mzdk
LTU4NjYtNDczNC04ZDJjLTgwMTljZGI3YTVjNSQAYTJhMGM5NzQtODk5ZC00NDRlLTk3OWQtODcy
MmI4MmE4Y2Mx+DUVAAAAAAAAJAAxMzViNDM3ZC01ODY2LTQ3MzQtOGQyYy04MDE5Y2RiN2E1YzUo
ADU0MjlhMmEwYzk3NC04OTlkLTQ0NGUtOTc5ZC04NzIyYjgyYThjYzH4NhUAAAAAAAAkADQ2YWRj
NWIzLTViYzItNGJhMC1iZWUzLTZhOTllZDFmMWI0ZiQAYjJiMjQ1ZWYtMTg1YS00ZjY4LWExODIt
MWQwMjFiODJjYmYy+DYVAAAAAAAAJAA0NmFkYzViMy01YmMyLTRiYTAtYmVlMy02YTk5ZWQxZjFi
NGYoADU0MzBiMmIyNDVlZi0xODVhLTRmNjgtYTE4Mi0xZDAyMWI4MmNiZjL4NxUAAAAAAAAkADQ2
YWRjNWIzLTViYzItNGJhMC1iZWUzLTZhOTllZDFmMWI0ZiQAYjJiMjQ1ZWYtMTg1YS00ZjY4LWEx
ODItMWQwMjFiODJjYmYy+DcVAAAAAAAAJAA0NmFkYzViMy01YmMyLTRiYTAtYmVlMy02YTk5ZWQx
ZjFiNGYoADU0MzFiMmIyNDVlZi0xODVhLTRmNjgtYTE4Mi0xZDAyMWI4MmNiZjL4OBUAAAAAAAAk
AGY3MmU0NzFiLWU5NzEtNGU1Yi1iMjJiLTg3ZDMyZDBiOTYxZiQANmY3Y2MxNGYtZGQyZC00MDU4
LWI5MjQtMTliMTdkNTc5Mzcy+DgVAAAAAAAAJABmNzJlNDcxYi1lOTcxLTRlNWItYjIyYi04N2Qz
MmQwYjk2MWYoADU0MzI2ZjdjYzE0Zi1kZDJkLTQwNTgtYjkyNC0xOWIxN2Q1NzkzNzL4ORUAAAAA
AAAkAGY3MmU0NzFiLWU5NzEtNGU1Yi1iMjJiLTg3ZDMyZDBiOTYxZiQANmY3Y2MxNGYtZGQyZC00
MDU4LWI5MjQtMTliMTdkNTc5Mzcy+DkVAAAAAAAAJABmNzJlNDcxYi1lOTcxLTRlNWItYjIyYi04
N2QzMmQwYjk2MWYoADU0MzM2ZjdjYzE0Zi1kZDJkLTQwNTgtYjkyNC0xOWIxN2Q1NzkzNzL4OhUA
AAAAAAAkADdkNjhmZTc3LTc4MTEtNDk2My04MTliLWU0OGVlY2EzNmZhYiQAMzJhNDE5MGItMzMy
MS00NmQwLTg0ZjQtMmM3ODk3ODJmODdl+DoVAAAAAAAAJAA3ZDY4ZmU3Ny03ODExLTQ5NjMtODE5
Yi1lNDhlZWNhMzZmYWIoADU0MzQzMmE0MTkwYi0zMzIxLTQ2ZDAtODRmNC0yYzc4OTc4MmY4N2X4
OxUAAAAAAAAkADdkNjhmZTc3LTc4MTEtNDk2My04MTliLWU0OGVlY2EzNmZhYiQAMzJhNDE5MGIt
MzMyMS00NmQwLTg0ZjQtMmM3ODk3ODJmODdl+DsVAAAAAAAAJAA3ZDY4ZmU3Ny03ODExLTQ5NjMt
ODE5Yi1lNDhlZWNhMzZmYWIoADU0MzUzMmE0MTkwYi0zMzIxLTQ2ZDAtODRmNC0yYzc4OTc4MmY4
N2X4PBUAAAAAAAAkADAzMmIxODYzLWE3YTctNGVhZi04ZDIxLTExY2M0YzdjYWFiYiQAYTlmMDBj
ZGMtNTUxZi00Njc1LWFjMWUtMzczNWZkNjI1YTI4+DwVAAAAAAAAJAAwMzJiMTg2My1hN2E3LTRl
YWYtOGQyMS0xMWNjNGM3Y2FhYmIoADU0MzZhOWYwMGNkYy01NTFmLTQ2NzUtYWMxZS0zNzM1ZmQ2
MjVhMjj4PRUAAAAAAAAkADAzMmIxODYzLWE3YTctNGVhZi04ZDIxLTExY2M0YzdjYWFiYiQAYTlm
MDBjZGMtNTUxZi00Njc1LWFjMWUtMzczNWZkNjI1YTI4+D0VAAAAAAAAJAAwMzJiMTg2My1hN2E3
LTRlYWYtOGQyMS0xMWNjNGM3Y2FhYmIoADU0MzdhOWYwMGNkYy01NTFmLTQ2NzUtYWMxZS0zNzM1
ZmQ2MjVhMjj4PhUAAAAAAAAkAGQyMDRhOThjLWM4YzgtNDI3OC04MjE5LWRiNDZhYTlkNjRkNCQA
ZjM2MTI2MGMtMzFkYy00M2YyLWFiMTMtZGY0NWM0OTZmMWZl+D4VAAAAAAAAJABkMjA0YTk4Yy1j
OGM4LTQyNzgtODIxOS1kYjQ2YWE5ZDY0ZDQoADU0MzhmMzYxMjYwYy0zMWRjLTQzZjItYWIxMy1k
ZjQ1YzQ5NmYxZmX4PxUAAAAAAAAkAGQyMDRhOThjLWM4YzgtNDI3OC04MjE5LWRiNDZhYTlkNjRk
NCQAZjM2MTI2MGMtMzFkYy00M2YyLWFiMTMtZGY0NWM0OTZmMWZl+D8VAAAAAAAAJABkMjA0YTk4
Yy1jOGM4LTQyNzgtODIxOS1kYjQ2YWE5ZDY0ZDQoADU0MzlmMzYxMjYwYy0zMWRjLTQzZjItYWIx
My1kZjQ1YzQ5NmYxZmX4QBUAAAAAAAAkAGUyODZkN2FkLWNmYTYtNGJiZS1iNTMwLTYzODNjOTY2
NjUwNCQANDQyMjM2YzAtZGZjZC00NTViLWEyMTgtZjE4YWNkOTBlZjMy+EAVAAAAAAAAJABlMjg2
ZDdhZC1jZmE2LTRiYmUtYjUzMC02MzgzYzk2NjY1MDQoADU0NDA0NDIyMzZjMC1kZmNkLTQ1NWIt
YTIxOC1mMThhY2Q5MGVmMzL4QRUAAAAAAAAkAGUyODZkN2FkLWNmYTYtNGJiZS1iNTMwLTYzODNj
OTY2NjUwNCQANDQyMjM2YzAtZGZjZC00NTViLWEyMTgtZjE4YWNkOTBlZjMy+EEVAAAAAAAAJABl
Mjg2ZDdhZC1jZmE2LTRiYmUtYjUzMC02MzgzYzk2NjY1MDQoADU0NDE0NDIyMzZjMC1kZmNkLTQ1
NWItYTIxOC1mMThhY2Q5MGVmMzL4QhUAAAAAAAAkADRkNjNjZTZhLWQxNWMtNDhmYS1iZDY4LWJl
MmY5ZDQyYjgwYSQAMmNlYTYwZjItYTE4OC00ZWVlLTkxYjUtMWU0ODFiZmMyOTdk+EIVAAAAAAAA
JAA0ZDYzY2U2YS1kMTVjLTQ4ZmEtYmQ2OC1iZTJmOWQ0MmI4MGEoADU0NDIyY2VhNjBmMi1hMTg4
LTRlZWUtOTFiNS0xZTQ4MWJmYzI5N2T4QxUAAAAAAAAkADRkNjNjZTZhLWQxNWMtNDhmYS1iZDY4
LWJlMmY5ZDQyYjgwYSQAMmNlYTYwZjItYTE4OC00ZWVlLTkxYjUtMWU0ODFiZmMyOTdk+EMVAAAA
AAAAJAA0ZDYzY2U2YS1kMTVjLTQ4ZmEtYmQ2OC1iZTJmOWQ0MmI4MGEoADU0NDMyY2VhNjBmMi1h
MTg4LTRlZWUtOTFiNS0xZTQ4MWJmYzI5N2T4RBUAAAAAAAAkADJiZjcxNzJlLWIxZTctNGI5ZS04
ZWNkLTljYjQxYTFlY2RhZiQAYWFiN2Y5YTQtZDIxMC00ZWVlLTk4MTMtMjUxMDgzM2M1ZmI4+EQV
AAAAAAAAJAAyYmY3MTcyZS1iMWU3LTRiOWUtOGVjZC05Y2I0MWExZWNkYWYoADU0NDRhYWI3Zjlh
NC1kMjEwLTRlZWUtOTgxMy0yNTEwODMzYzVmYjj4RRUAAAAAAAAkADJiZjcxNzJlLWIxZTctNGI5
ZS04ZWNkLTljYjQxYTFlY2RhZiQAYWFiN2Y5YTQtZDIxMC00ZWVlLTk4MTMtMjUxMDgzM2M1ZmI4
+EUVAAAAAAAAJAAyYmY3MTcyZS1iMWU3LTRiOWUtOGVjZC05Y2I0MWExZWNkYWYoADU0NDVhYWI3
ZjlhNC1kMjEwLTRlZWUtOTgxMy0yNTEwODMzYzVmYjj4RhUAAAAAAAAkADU5ZTEzNjIyLWJhOTIt
NGM4Zi05ZTkzLWQ3NTJmNTUzYWY2MSQAODRmYWU2MzQtNzExYy00OWMzLWI5MDgtZmRkZWU2NWNk
ZDBk+EYVAAAAAAAAJAA1OWUxMzYyMi1iYTkyLTRjOGYtOWU5My1kNzUyZjU1M2FmNjEoADU0NDY4
NGZhZTYzNC03MTFjLTQ5YzMtYjkwOC1mZGRlZTY1Y2RkMGT4RxUAAAAAAAAkADU5ZTEzNjIyLWJh
OTItNGM4Zi05ZTkzLWQ3NTJmNTUzYWY2MSQAODRmYWU2MzQtNzExYy00OWMzLWI5MDgtZmRkZWU2
NWNkZDBk+EcVAAAAAAAAJAA1OWUxMzYyMi1iYTkyLTRjOGYtOWU5My1kNzUyZjU1M2FmNjEoADU0
NDc4NGZhZTYzNC03MTFjLTQ5YzMtYjkwOC1mZGRlZTY1Y2RkMGT4SBUAAAAAAAAkADQ5OGRiY2U4
LTkzZjYtNGNmNi1iMTUzLWFlY2E5N2U0MzFjMSQAMDNlZTcxMTItYTUwNC00MWI5LThlZDMtNzNh
YWU0MGM1M2U5+EgVAAAAAAAAJAA0OThkYmNlOC05M2Y2LTRjZjYtYjE1My1hZWNhOTdlNDMxYzEo
ADU0NDgwM2VlNzExMi1hNTA0LTQxYjktOGVkMy03M2FhZTQwYzUzZTn4SRUAAAAAAAAkADQ5OGRi
Y2U4LTkzZjYtNGNmNi1iMTUzLWFlY2E5N2U0MzFjMSQAMDNlZTcxMTItYTUwNC00MWI5LThlZDMt
NzNhYWU0MGM1M2U5+EkVAAAAAAAAJAA0OThkYmNlOC05M2Y2LTRjZjYtYjE1My1hZWNhOTdlNDMx
YzEoADU0NDkwM2VlNzExMi1hNTA0LTQxYjktOGVkMy03M2FhZTQwYzUzZTn4ShUAAAAAAAAkADFl
M2M2NzViLTdkZWQtNDY3Yy1iNjFlLTg4ZTY1ZTc3YzYxYSQAY2ZjMWI3ZWQtYjU5Mi00NjI1LTli
YjgtZDNkZjc5YmYyNGI2+EoVAAAAAAAAJAAxZTNjNjc1Yi03ZGVkLTQ2N2MtYjYxZS04OGU2NWU3
N2M2MWEoADU0NTBjZmMxYjdlZC1iNTkyLTQ2MjUtOWJiOC1kM2RmNzliZjI0Yjb4SxUAAAAAAAAk
ADFlM2M2NzViLTdkZWQtNDY3Yy1iNjFlLTg4ZTY1ZTc3YzYxYSQAY2ZjMWI3ZWQtYjU5Mi00NjI1
LTliYjgtZDNkZjc5YmYyNGI2+EsVAAAAAAAAJAAxZTNjNjc1Yi03ZGVkLTQ2N2MtYjYxZS04OGU2
NWU3N2M2MWEoADU0NTFjZmMxYjdlZC1iNTkyLTQ2MjUtOWJiOC1kM2RmNzliZjI0Yjb4TBUAAAAA
AAAkADc5ZWJjNzExLTMwMDctNDAyMy05YTRkLTU5MmRmZTRlYjE5ZSQAYjJmMjJjODEtN2VmZS00
NzA4LTgwZDAtNTJjZDNmYzg1MGE2+EwVAAAAAAAAJAA3OWViYzcxMS0zMDA3LTQwMjMtOWE0ZC01
OTJkZmU0ZWIxOWUoADU0NTJiMmYyMmM4MS03ZWZlLTQ3MDgtODBkMC01MmNkM2ZjODUwYTb4TRUA
AAAAAAAkADc5ZWJjNzExLTMwMDctNDAyMy05YTRkLTU5MmRmZTRlYjE5ZSQAYjJmMjJjODEtN2Vm
ZS00NzA4LTgwZDAtNTJjZDNmYzg1MGE2+E0VAAAAAAAAJAA3OWViYzcxMS0zMDA3LTQwMjMtOWE0
ZC01OTJkZmU0ZWIxOWUoADU0NTNiMmYyMmM4MS03ZWZlLTQ3MDgtODBkMC01MmNkM2ZjODUwYTb4
ThUAAAAAAAAkADFjNGViMjZlLWQxYzktNDZkZi1hNTUxLWVhODkzODEzM2I4MSQAYjg3YjhkZDYt
MjE1NS00NGExLWEyODAtN2E1OGFiM2RmYTgz+E4VAAAAAAAAJAAxYzRlYjI2ZS1kMWM5LTQ2ZGYt
YTU1MS1lYTg5MzgxMzNiODEoADU0NTRiODdiOGRkNi0yMTU1LTQ0YTEtYTI4MC03YTU4YWIzZGZh
ODNJgEvG`

	bts, err := base64.StdEncoding.DecodeString(str)
	if err != nil {
		fmt.Println(err)
		return
	}
	fmt.Println(len(bts), ",  ", len(str))
}

func TestBytesSplit(t *testing.T) {
	ddls := "create table abc(id int auto_increment primary key, name varchar(255)); alter table abc rename to abcd"

	bts := bytes.Split([]byte(ddls), []byte(";"))
	for _, ddl := range bts {
		fmt.Println(string(ddl))
	}
}

func TestFormatDescEvent(t *testing.T) {
	str := `iuy5Wg8VAAAAdAAAAHgAAAABAAQANS42LjM5LWxvZwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAACK7LlaEzgNAAgAEgAEBAQEEgAAXAAEGggAAAAICAgCAAAACgoKGRkAAT+L
S/k=`
	bts, err := base64.StdEncoding.DecodeString(str)
	if err != nil {
		fmt.Println(err)
		return
	}
	fmt.Println(bts)

	fde := &replication.FormatDescriptionEvent{}
	fde.Decode(bts[19:])
	fmt.Println(fde)
}

func TestMergeConfig_Close(t *testing.T) {
	fs, _ := os.OpenFile("/tmp/test001", os.O_CREATE|os.O_RDWR|os.O_TRUNC, 0755)
	fs.Sync()
	fs.Close()
	fmt.Println(fs.Name())
	os.Remove(fs.Name())
}
